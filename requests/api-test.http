### Create User
POST http://127.0.0.1:8080/api/v1/users/register HTTP/1.1
Content-Type: application/json

{
    "firstName":"John",
    "lastName":"Doe",
    "email":"minhnq.24it@vku.udn.vn",
    "password":"12345678",
    "matchingPassword":"12345678",
    "phoneNumber":"0905123456",
    "address":"123 A street"
}

### Resend Verification Token
GET http://127.0.0.1:8080/api/v1/users/resend-verify-token?email=minhnq.24it@vku.udn.vn HTTP/1.1

### ============================================
### IMPROVED PASSWORD RESET FLOW
### ============================================
### 
### NEW FLOW (Better UX, More RESTful):
### 1. POST /forgot-password → Email sent with link: http://frontend.com/reset-password?token=xxx
### 2. User clicks link → Frontend displays password reset form (token extracted from URL)
### 3. User submits form → POST /api/v1/users/reset-password?token=xxx
### 4. Backend validates token AND resets password in one step
### 
### Benefits:
### - Better UX (frontend handles form display)
### - More RESTful (single POST operation, no GET endpoint needed)
### - Simpler API (one less endpoint)
### ============================================

### Step 1: Forgot Password - Request password reset
### User provides email, receives reset link via email
### Email link points to FRONTEND: http://localhost:3000/reset-password?token=xxx
POST http://127.0.0.1:8080/api/v1/users/forgot-password HTTP/1.1
Content-Type: application/json

{
    "email":"minhnq.24it@vku.udn.vn"
}

### Step 2: Reset Password - User submits new password
### 
### IMPROVED: No GET endpoint needed! Frontend extracts token from URL and submits directly.
### 
### Option A: Token in query parameter (RECOMMENDED - Better UX!)
### Frontend extracts token from URL: http://frontend.com/reset-password?token=xxx
### Then submits: POST /api/v1/users/reset-password?token=xxx
POST http://127.0.0.1:8080/api/v1/users/reset-password?token=baae396c-6278-4f0f-b662-f77209fac5bc HTTP/1.1
Content-Type: application/json

{
    "password":"user1234",
    "matchingPassword":"user1234"
}

### Option B: Token in request body (Alternative)
### If frontend prefers to send token in JSON body instead of query parameter
POST http://127.0.0.1:8080/api/v1/users/reset-password HTTP/1.1
Content-Type: application/json

{
    "token":"c0f43679-79fb-4ccd-a5de-5652c97bcb1d",
    "password":"user1234",
    "matchingPassword":"user1234"
}

### Test Validation Errors - Password too short
POST http://127.0.0.1:8080/api/v1/users/reset-password?token=baae396c-6278-4f0f-b662-f77209fac5bc HTTP/1.1
Content-Type: application/json

{
    "password":"123",
    "matchingPassword":"123"
}

### Test Validation Errors - Passwords don't match
POST http://127.0.0.1:8080/api/v1/users/reset-password?token=baae396c-6278-4f0f-b662-f77209fac5bc HTTP/1.1
Content-Type: application/json

{
    "password":"user1234",
    "matchingPassword":"different1234"
}

### Change Password - For authenticated users (REQUIRES AUTHENTICATION)
### ⚠️ IMPORTANT: You DON'T need to log in first! Just send credentials with this request.
### 
### Option A: HTTP Basic Auth (RECOMMENDED for REST APIs - NO FRONTEND NEEDED!)
### 
### How it works:
### 1. You already have a user account (from registration)
### 2. Send credentials in the Authorization header with THIS request
### 3. Server validates credentials and processes the request
### 
### Format: Authorization: Basic base64(email:password)
### 
### Example with your credentials:
### Email: minhnq.24it@vku.udn.vn
### Password: 12345678
### Base64("minhnq.24it@vku.udn.vn:12345678") = bWlobm5xLjI0aXRAdmt1LnVkbi52bjoxMjM0NTY3OA==
### 
### To generate base64: Use online tool or VS Code REST Client will do it automatically!
POST http://127.0.0.1:8080/api/v1/users/change-password HTTP/1.1
Content-Type: application/json
Authorization: Basic bWlobm5xLjI0aXRAdmt1LnVkbi52bjoxMjM0NTY3OA==
# ⚠️ The base64 string above IS what gets sent to the server (not just for clarification!)
# This is the actual encoded credentials: base64("minhnq.24it@vku.udn.vn:12345678")
# 
# To use different credentials:
# Option 1: Generate base64 manually at https://www.base64encode.org/
#   - Encode: "your-email@example.com:your-password"
#   - Replace the string after "Basic " above
# 
# Option 2: VS Code REST Client supports inline credentials (if extension supports it):
#   Authorization: Basic minhnq.24it@vku.udn.vn:12345678
#   (Some REST Client extensions auto-encode, but the standard way is base64)

{
    "currentPassword":"12345678",
    "password":"newPassword123",
    "matchingPassword":"newPassword123"
}

### Change Password - Option B: Form Login (for web browsers)
### If you're using form login, you need to login via /login first
### Then Spring Security will use the session cookie for authentication
POST http://127.0.0.1:8080/api/v1/users/change-password HTTP/1.1
Content-Type: application/json
Cookie: JSESSIONID=your-session-id-here
# Note: Replace JSESSIONID with your actual session cookie after logging in

{
    "currentPassword":"oldPassword123",
    "password":"newPassword123",
    "matchingPassword":"newPassword123"
}

### Test Change Password - Wrong current password
POST http://127.0.0.1:8080/api/v1/users/change-password HTTP/1.1
Content-Type: application/json

{
    "currentPassword":"wrongPassword",
    "password":"newPassword123",
    "matchingPassword":"newPassword123"
}

### Test Change Password - New password same as current
POST http://127.0.0.1:8080/api/v1/users/change-password HTTP/1.1
Content-Type: application/json

{
    "currentPassword":"oldPassword123",
    "password":"oldPassword123",
    "matchingPassword":"oldPassword123"
}