### Create User
POST http://127.0.0.1:8080/api/v1/users/register HTTP/1.1
Content-Type: application/json

{
    "firstName":"John",
    "lastName":"Doe",
    "email":"minhnq.24it@vku.udn.vn",
    "password":"12345678",
    "matchingPassword":"12345678",
    "phoneNumber":"0905123456",
    "address":"123 A street"
}

### Resend Verification Token
GET http://127.0.0.1:8080/api/v1/users/resend-verify-token?email=minhnq.24it@vku.udn.vn HTTP/1.1

### Forgot Password -> Enter email
POST http://127.0.0.1:8080/api/v1/users/forgot-password HTTP/1.1
Content-Type: application/json

{
    "email":"minhnq.24it@vku.udn.vn"
}

### Validate Reset Token (Step 2) - User clicks email link
GET http://127.0.0.1:8080/api/v1/users/reset-password?token=c0f43679-79fb-4ccd-a5de-5652c97bcb1d HTTP/1.1

### Reset Password (Step 3) - Option A: Token in query parameter (BETTER UX - no copy/paste needed!)
POST http://127.0.0.1:8080/api/v1/users/reset-password?token=baae396c-6278-4f0f-b662-f77209fac5bc HTTP/1.1
Content-Type: application/json

{
    "password":"user1234",
    "matchingPassword":"user1234"
}

### Reset Password (Step 3) - Option B: Token in request body (Alternative)
POST http://127.0.0.1:8080/api/v1/users/reset-password HTTP/1.1
Content-Type: application/json

{
    "token":"c0f43679-79fb-4ccd-a5de-5652c97bcb1d",
    "password":"user1234",
    "matchingPassword":"user1234"
}

### Test Validation Errors - Password too short
POST http://127.0.0.1:8080/api/v1/users/reset-password?token=baae396c-6278-4f0f-b662-f77209fac5bc HTTP/1.1
Content-Type: application/json

{
    "password":"123",
    "matchingPassword":"123"
}

### Test Validation Errors - Passwords don't match
POST http://127.0.0.1:8080/api/v1/users/reset-password?token=baae396c-6278-4f0f-b662-f77209fac5bc HTTP/1.1
Content-Type: application/json

{
    "password":"user1234",
    "matchingPassword":"different1234"
}

### Change Password - For authenticated users (REQUIRES AUTHENTICATION)
### Option A: HTTP Basic Auth (RECOMMENDED for REST APIs)
### Format: Authorization: Basic base64(email:password)
### Example: If email is "user@example.com" and password is "password123"
### Then base64("user@example.com:password123") = "dXNlckBleGFtcGxlLmNvbTpwYXNzd29yZDEyMw=="
POST http://127.0.0.1:8080/api/v1/users/change-password HTTP/1.1
Content-Type: application/json
Authorization: Basic dXNlckBleGFtcGxlLmNvbTpwYXNzd29yZDEyMw==
# Replace the Authorization header with your actual email:password base64 encoded
# In Postman: Go to Authorization tab → Type: Basic Auth → Enter email and password

{
    "currentPassword":"oldPassword123",
    "password":"newPassword123",
    "matchingPassword":"newPassword123"
}

### Change Password - Option B: Form Login (for web browsers)
### If you're using form login, you need to login via /login first
### Then Spring Security will use the session cookie for authentication
POST http://127.0.0.1:8080/api/v1/users/change-password HTTP/1.1
Content-Type: application/json
Cookie: JSESSIONID=your-session-id-here
# Note: Replace JSESSIONID with your actual session cookie after logging in

{
    "currentPassword":"oldPassword123",
    "password":"newPassword123",
    "matchingPassword":"newPassword123"
}

### Test Change Password - Wrong current password
POST http://127.0.0.1:8080/api/v1/users/change-password HTTP/1.1
Content-Type: application/json

{
    "currentPassword":"wrongPassword",
    "password":"newPassword123",
    "matchingPassword":"newPassword123"
}

### Test Change Password - New password same as current
POST http://127.0.0.1:8080/api/v1/users/change-password HTTP/1.1
Content-Type: application/json

{
    "currentPassword":"oldPassword123",
    "password":"oldPassword123",
    "matchingPassword":"oldPassword123"
}